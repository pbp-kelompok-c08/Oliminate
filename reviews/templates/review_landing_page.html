{% extends 'base.html' %}
{% load static %}

{% block meta %}
<title>Review Events</title>
<link rel="stylesheet" href="{% static 'css/global.css' %}">
{% endblock meta %}

{% block content %}
<div class="container mt-2">
  <div class="flex justify-between items-center mb-6">
    <h1 class="h3">Review Events</h1>
  </div>

  {% if event_list %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" style="margin-top: 1rem;">
      {% for event in event_list %}
      <div class="card schedule-card flex flex-col"
           style="margin:0; display:flex; flex-direction:column; overflow:hidden; border-radius:12px; background:white;">
        {% if event.image_url %}
          <img src="{{ event.image_url }}" alt="{{ event.category }}"
               style="width:100%; height:200px; object-fit:cover; border-radius:12px 12px 0 0;">
        {% else %}
          <div style="background-color:var(--neutral-100); height:200px; display:flex; align-items:center; justify-content:center;">
            <span class="footnote">No Image</span>
          </div>
        {% endif %}

        <div style="padding:16px; flex:1;">
          <h2 class="h5">{{ event.team1 }} vs {{ event.team2 }}</h2>
          <!-- RATING SECTION -->
          <div style="display:flex; align-items:center; gap:8px; margin:12px 0;">
            <div style="font-size:18px; letter-spacing:1px;">
              {% with rounded_rating=event.avg_rating|default:0|floatformat:0 %}
              {% for i in "12345" %}
                {% if forloop.counter <= rounded_rating|add:0 %}
                  <span style="color:#f59e0b;">★</span>
                {% else %}
                  <span style="color:var(--neutral-300);">☆</span>
                {% endif %}
              {% endfor %}
              {% endwith %}
            </div>
            <span class="footnote" style="font-weight:var(--font-medium);">
              <b>{{ event.avg_rating|default:0|floatformat:1 }}</b> ({{ event.review_count|default:0 }} reviews)
            </span>
          </div>
          <p class="footnote">{{ event.category }} — {{ event.location }}</p>
          

          <p class="footnote" style="margin-top:8px;">{{ event.caption|truncatechars:80|default:"No description" }}</p>
          <p class="headline" style="color:var(--pacil-blue-base); margin-top:8px;">
            {{ event.start_time|date:"d M Y" }} | {{ event.start_time|date:"H:i" }}
          </p>
        </div>

        <div style="padding:0 16px 16px 16px;">
          <a href="{% url 'review_detail' event.id %}" class="btn btn-outline w-full">See Reviews</a>
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="card">
      <p class="body">There are no reviewable events at this time.</p>
    </div>
  {% endif %}
</div>

<style>
.container > .grid {
  display: grid ;
  gap: 1rem ; 
}

.card {
  margin: 0 ;
  display: block ;
}

.schedule-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.08);
  transition: all 0.25s ease;
}
</style>
{% endblock content %}