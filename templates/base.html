{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>{% block title %}Oliminate{% endblock %}</title>

    <link rel="stylesheet" href="{% static 'css/global.css' %}" />

    {% block styles %}{% endblock styles %}
  </head>

  <body class="flex flex-col min-h-screen font-sans bg-[var(--neutral-50)] text-[var(--neutral-900)]">
    <!-- NAVBAR -->
    <nav class="bg-[var(--pacil-blue-darker-2)] shadow-md py-3">
      <div class="container mx-auto flex justify-between items-center px-4">
        <!-- Logo -->
        <a href="/" class="text-xl font-semibold text-[var(--neutral-50)]">Oliminate</a>

        <!-- Hamburger (mobile) -->
        <button
          id="menu-toggle"
          class="md:hidden flex flex-col justify-center items-center space-y-1.5 focus:outline-none focus:ring-2 focus:ring-white/60 rounded-md p-1 transition"
          aria-label="Toggle Menu"
          aria-controls="mobile-menu"
          aria-expanded="false"
        >
          <span class="bar-1 w-6 h-0.5 bg-white transition-all duration-300 origin-center"></span>
          <span class="bar-2 w-6 h-0.5 bg-white transition-all duration-300 origin-center"></span>
          <span class="bar-3 w-6 h-0.5 bg-white transition-all duration-300 origin-center"></span>
        </button>

        <!-- Menu utama (desktop) -->
        <div class="hidden md:flex gap-6 items-center text-[var(--neutral-50)] text-sm md:text-base">
          <a href="/" class="hover:underline">Home</a>
          <a href="/scheduling/" class="hover:underline">Scheduling</a>
          <a href="/ticketing/" class="hover:underline">Ticketing</a>
          <a href="/merchandise/" class="hover:underline">Merchandise</a>
          <a href="/review/" class="hover:underline">Review</a>

          <div class="flex flex-wrap justify-center md:justify-end gap-2">
            {% if user.is_authenticated %}
              <a
                href="{% url 'users:main_profile' %}"
                class="border border-[var(--neutral-50)] text-[var(--neutral-50)] px-3 py-1 rounded-lg hover:bg-[var(--neutral-50)] hover:text-[var(--pacil-blue-darker-2)] transition"
              >Profile</a>
              <form action="{% url 'users:logout' %}" method="post" class="inline-block">
                {% csrf_token %}
                <button
                  type="submit"
                  class="bg-[var(--neutral-50)] text-[var(--pacil-blue-darker-2)] px-3 py-1 rounded-lg font-medium hover:opacity-90 transition"
                >
                  Logout
                </button>
              </form>
            {% else %}
              <a
                href="{% url 'users:login' %}"
                class="border border-[var(--neutral-50)] text-[var(--neutral-50)] px-3 py-1 rounded-lg hover:bg-[var(--neutral-50)] hover:text-[var(--pacil-blue-darker-2)] transition"
              >Login</a>
              <a
                href="{% url 'users:register' %}"
                class="bg-[var(--neutral-50)] text-[var(--pacil-blue-darker-2)] px-3 py-1 rounded-lg font-medium hover:opacity-90 transition"
              >Register</a>
            {% endif %}
          </div>
        </div>
      </div>

      <!-- Mobile Dropdown Menu -->
      <div
        id="mobile-menu"
        class="hidden md:hidden flex-col space-y-2 py-3 px-6 text-[var(--neutral-50)] bg-[var(--pacil-blue-darker-2)] border-t border-[var(--pacil-blue-lighter-1)]"
      >
        <a href="/" class="block hover:underline">Home</a>
        <a href="/scheduling/" class="block hover:underline">Scheduling</a>
        <a href="/ticketing/" class="block hover:underline">Ticketing</a>
        <a href="/merchandise/" class="block hover:underline">Merchandise</a>
        <a href="/review/" class="block hover:underline">Review</a>

        {% if user.is_authenticated %}
          <a href="{% url 'users:main_profile' %}" class="block border border-[var(--neutral-50)] text-center rounded-lg py-1 mt-2">Profile</a>
          <form action="{% url 'users:logout' %}" method="post" class="mt-2">
            {% csrf_token %}
            <button type="submit" class="w-full bg-[var(--neutral-50)] text-[var(--pacil-blue-darker-2)] rounded-lg py-1 font-medium">Logout</button>
          </form>
        {% else %}
          <a href="{% url 'users:login' %}" class="block border border-[var(--neutral-50)] text-center rounded-lg py-1 mt-2">Login</a>
          <a href="{% url 'users:register' %}" class="block bg-[var(--neutral-50)] text-[var(--pacil-blue-darker-2)] text-center rounded-lg py-1 mt-2 font-medium">Register</a>
        {% endif %}
      </div>
    </nav>

    <!-- CONTENT -->
    <main class="flex-1 flex flex-col">
      {% block content %}{% endblock %}
    </main>

    <!-- FOOTER -->
    <footer class="bg-[var(--pacil-blue-darker-2)] text-[var(--neutral-50)] text-center py-4 text-sm mt-auto">
      Â© 2025 Oliminate
    </footer>

    {% block scripts %}
    <script>
      const menuToggle = document.getElementById("menu-toggle");
      const mobileMenu = document.getElementById("mobile-menu");
      const bar1 = menuToggle?.querySelector(".bar-1");
      const bar2 = menuToggle?.querySelector(".bar-2");
      const bar3 = menuToggle?.querySelector(".bar-3");

      let open = false;

      function openMenu() {
        open = true;
        menuToggle.setAttribute("aria-expanded", "true");
        mobileMenu.classList.remove("hidden");
        bar1.classList.add("translate-y-1.5","rotate-45");
        bar2.classList.add("opacity-0");
        bar3.classList.add("-translate-y-1.5","-rotate-45");
      }

      function closeMenu() {
        open = false;
        menuToggle.setAttribute("aria-expanded", "false");
        mobileMenu.classList.add("hidden");
        bar1.classList.remove("translate-y-1.5","rotate-45");
        bar2.classList.remove("opacity-0");
        bar3.classList.remove("-translate-y-1.5","-rotate-45");
      }

      menuToggle?.addEventListener("click", () => {
        open ? closeMenu() : openMenu();
      });

      window.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && open) closeMenu();
      });
    </script>
    {% endblock %}

    {% block extra_scripts %}{% endblock %}
  </body>
</html>
