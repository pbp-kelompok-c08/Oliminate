{% extends 'base.html' %}
{% load static %}

{% block content %}
<header>
    <h1 class="heading-1 text-blue-darker-1">Welcome to Oliminate!</h1>
</header>

<main>
    <section class="text-box">
        <h3 class="heading-4" style="margin-top: 0;">What is OLIMINATE?</h3>
        <p class="body-large">
            Oliminate is an application designed to help event organizers manage competitions efficiently and in an integrated manner.
This product was created by the C08 Group with the aim of simplifying competition event management, from scheduling and ticket sales to the live and online viewing experience.
        </p>
    </section>

    <section>
        <h2 class="heading-3 text-blue-darker-1">Our Competitions</h2>

        <div class="carousel-container" id="competition-carousel">
            <div class="carousel-track">
                <div class="carousel-card"><h4>Valorant</h4></div>
                <div class="carousel-card"><h4>Tennis</h4></div>
                <div class="carousel-card"><h4>Futsal</h4></div>
                <div class="carousel-card"><h4>Badminton</h4></div>
                <div class="carousel-card"><h4>Chess</h4></div>
                <div class="carousel-card"><h4>Basketball</h4></div>
            </div>
            <button class="carousel-button prev"><i class="fa fa-chevron-left"></i></button>
            <button class="carousel-button next"><i class="fa fa-chevron-right"></i></button>
        </div>
    </section>

    <section>
        <h2 class="heading-3 text-blue-darker-1">Upcoming Schedule</h2>

        <div class="carousel-container" id="schedule-carousel">
            <div class="carousel-track">
                <div class="carousel-card">
                    <p>18.00 - 19.30</p>
                    <p>21-11-2024</p>
                    <h4>BASKET</h4>
                    <p>FT vs FKM</p>
                </div>
                <div class="carousel-card">
                    <p>18.30 - 22.00</p>
                    <p>24-10-2024</p>
                    <h4>VALORANT</h4>
                    <p>FPSI vs FKM</p>
                </div>
                <div class="carousel-card">
                    <p>19.30 - 20.30</p>
                    <p>22-11-2024</p>
                    <h4>TENIS LAPANGAN</h4>
                    <p>FK vs FASILKOM</p>
                </div>
                <div class="carousel-card">
                    <p>19.30 - 21.15</p>
                    <p>20-11-2024</p>
                    <h4>BASKET</h4>
                    <p>FKG vs FT</p>
                </div>
                </div>
            <button class="carousel-button prev"><i class="fa fa-chevron-left"></i></button>
            <button class="carousel-button next"><i class="fa fa-chevron-right"></i></button>
        </div>
    </section>

    <section class="button-wrapper">
        <h3 class="heading-4">Explore More!</h3>
        
        {% if user.is_authenticated %}
            <a href="{% url 'users:profile' %}" class="btn btn-primary">My Profile</a>
        {% else %}
            <a href="{% url 'users:register' %}" class="btn btn-primary">Sign me UP!</a>
        {% endif %}
    </section>

</main>
{% endblock %}


{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        /**
         * Fungsi untuk mengatur sebuah carousel.
         * @param {string} containerId - ID dari .carousel-container
         * @param {number} intervalTime - Waktu auto-slide dalam milidetik
         */
        function setupCarousel(containerId, intervalTime = 3000) {
            const container = document.getElementById(containerId);
            if (!container) return; // Keluar jika container tidak ditemukan

            const track = container.querySelector('.carousel-track');
            const cards = container.querySelectorAll('.carousel-card');
            const prevBtn = container.querySelector('.carousel-button.prev');
            const nextBtn = container.querySelector('.carousel-button.next');
            
            // Perlu minimal 1 kartu untuk berfungsi
            if (cards.length === 0) return; 

            let currentIndex = 0;
            const cardStyle = window.getComputedStyle(cards[0]);
            const cardMargin = parseFloat(cardStyle.marginLeft) + parseFloat(cardStyle.marginRight);
            const cardWidth = cards[0].offsetWidth + cardMargin;
            
            // Asumsi 3 kartu terlihat
            const visibleCards = 3;
            // Kita hanya bisa slide sampai (total kartu - kartu yang terlihat)
            const maxIndex = Math.max(0, cards.length - visibleCards);

            // Variabel untuk menyimpan interval auto-slide
            let autoSlideInterval = null;

            function slideNext() {
                currentIndex++;
                // Jika sudah di akhir, kembali ke awal
                if (currentIndex > maxIndex) {
                    currentIndex = 0;
                }
                updateTrackPosition();
            }

            function slidePrev() {
                currentIndex--;
                // Jika sudah di awal, pindah ke akhir
                if (currentIndex < 0) {
                    currentIndex = maxIndex;
                }
                updateTrackPosition();
            }

            function updateTrackPosition() {
                track.style.transform = `translateX(-${currentIndex * cardWidth}px)`;
            }

            // Fungsi untuk memulai/mereset auto-slide
            function startAutoSlide() {
                // Hentikan dulu jika sedang berjalan
                if (autoSlideInterval) {
                    clearInterval(autoSlideInterval);
                }
                // Mulai interval baru
                autoSlideInterval = setInterval(slideNext, intervalTime);
            }

            // Fungsi untuk menghentikan auto-slide
            function stopAutoSlide() {
                clearInterval(autoSlideInterval);
                autoSlideInterval = null; // Tandai bahwa auto-slide berhenti
            }

            // Hentikan auto-slide jika tombol arrow ditekan
            nextBtn.addEventListener('click', () => {
                if (autoSlideInterval) stopAutoSlide();
                slideNext();
            });

            prevBtn.addEventListener('click', () => {
                if (autoSlideInterval) stopAutoSlide();
                slidePrev();
            });

            // Mulai auto-slide saat halaman dimuat
            if (maxIndex > 0) { // Hanya mulai jika ada cukup kartu untuk digeser
                startAutoSlide();
            }
        }

        // Terapkan fungsi ke kedua carousel
        setupCarousel('competition-carousel', 3000);
        setupCarousel('schedule-carousel', 3500); // Bisa dengan interval berbeda
    });
</script>
{% endblock %}